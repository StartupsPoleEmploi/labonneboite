{"query": {"function_score": {"boost_mode": "multiply",
                               "functions": [{"random_score": {"seed": "2022-02-17"}}],
                               "query": {"function_score": {"boost_mode": "replace",
                                                            "functions": [{"field_value_factor": {"field": "scores_by_rome.rome1",
                                                                                                  "missing": 0,
                                                                                                  "modifier": "none"}}],
                                                            "query": {"filtered": {"filter": {"bool": {"must": [{"range": {"score": {"gt": 0}}},
                                                                                                                {"terms": {"naf": ["naf1"]}},
                                                                                                                {"bool": {"should": [{"exists": {"field": "scores_by_rome.rome1"}}]}},
                                                                                                                {"geo_distance": {"distance": "10km",
                                                                                                                                  "locations": {"lat": 1.256,
                                                                                                                                                "lon": 2.123}}}]}}}},
                                                            "score_mode": "max"}},
                               "score_mode": "multiply"}},
  "sort": [{"boosted_romes.rome1": {"ignore_unmapped": true,
                                    "missing": "_last"}},
           "_score",
           {"_geo_distance": {"locations": {"lat": 1.256, "lon": 2.123},
                              "order": "asc",
                              "unit": "km"}}]}
